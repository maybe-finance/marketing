<%
  title @article.title
  description "#{markdown(@article.content).gsub(%r{</?[^>]+?>}, '')[0...300]}..."
  meta_image @article.meta_image_url if @article.meta_image_url.present?
%>
<div class="max-w-[1140px] mx-auto space-y-4 mt-10">
  <%= link_to articles_path, class: "h-6 flex flex-row rounded-full gap-[6px] w-fit mb-6 pr-2 items-center text-gray-900 hover:bg-gray-200/50" do %>
    <%= lucide_icon("arrow-left", class: "rounded-full h-5 w-5 p-1 bg-gray-100 hover:bg-gray-200/50") %>
    <span class="text-sm">Back to articles</span>
  <% end %>
  <article>
    <%= tag.div class: "min-h-[480px] mb-10 border bg-gradient-to-b #{article_gradient(@article)}" %>
    <span class="flex font-mono text-xs font-medium mb-4 text-gray-500 uppercase">
      <%= @article.publish_at.to_date.strftime("%B %-d, %Y") %> &#x2022; <%= article_reading_time(@article) %> &#x2022; INVESTING
    </span>
    <div class="flex flex-row w-full gap-[56px]">
      <div class="flex flex-col w-full max-w-[680px] gap-1">
        <h1 class="text-5xl leading-[3.5rem] font-medium mb-4 text-gray-900"><%= @article.title %></h1>
        <% if @article.author_name.present? %>
          <div class="flex flex-row gap-3 mb-6">
            <%= author_image_tag @article.author_name, class: "w-10 h-10 rounded-full bg-gray-500 mb-3" %>
            <span class="flex flex-col">
              <p class="text-base leading-5 mb-[2px]"><%= @article.author_name %></p>
            </span>
          </div>
        <% end %>
        <div class="prose text-gray-600">
          <%= markdown @article.content %>
        </div>
      </div>
      <div class="w-auto">
        <%= image_tag "maybe-logo-glow-4x.png", alt: "Maybe Logo", style:"width: 68px; margin: -14px 0 0 -13px;", class: "mb-4" %>
        <p class="text-base text-gray-500 mb-4">Subscribe to get the latest updates right in your inbox!</p>
        <div class="mb-8">
          <%= form_with( url: signups_path) do |f| %>
            <div class="flex flex-row w-full p-1 mb-4 bg-white border shadow-xs rounded-xl mt-0">
              <%= f.email_field :email, placeholder: "Enter your email address", class: "flex-1 border-0 px-2 focus:ring-0 text-sm", required: true %>
              <%= f.submit "Subscribe", class: "py-2 px-3 font-medium text-white bg-gray-900 rounded-lg hover:bg-gray-800 border border-gray-900 text-sm" %>
            </div>
          <% end %>
        </div>
        <div class="flex flex-col gap-4 mb-8">
          <h2 class="text-xl leading-8 tracking-[-0.01em] font-medium text-gray-900">More articles</h2>
          <% Article.random_sample(3, exclude: @article).each do |article| %>
            <%= link_to article, class: "grid grid-cols-[96px_auto] gap-4 bg-white shadow-xs rounded-2xl border p-3" do %>
              <%= tag.div class: "min-h-[72px] rounded-lg bg-gradient-to-b #{article_gradient(article)}" %>
              <div class="flex flex-col justify-between text-left">
                <div class="space-y-2">
                  <h2 class ="text-2xl font-medium text-gray-900"><%= article.title %></h2>
                  <span class="font-mono text-xs font-medium text-gray-500 uppercase">
                    <%= article.publish_at.to_date.strftime("%B %-d, %Y") %> — <%= article_reading_time(article) %>
                  </span>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
        <div class="flex flex-col gap-3">
          <h2 class="text-xl leading-8 tracking-[-0.01em] font-medium text-gray-900">Share this article</h2>
          <%= render "shared/share_buttons" %>
        </div>
      </div>
    </div>
  </article>
</div>
